{% extends "layout.html" %}

{% block content %}
<!-- Button-Like Nav (placed above the table) -->
<div class="flex justify-end mb-2">
  <nav class="flex border-2 rounded-lg border-primaryHighlight">
    <!-- Logs Link (selected) -->
    <a
      href="{% url 'logs_page' %}"
      class="py-2 px-6 text-sm font-normal border-r-2 border-primaryHighlight
             transition-all duration-200 select-none cursor-pointer 
             hover:text-accent hover:bg-primaryHighlight
             bg-primaryHighlight text-accent"
    >
      Logs
    </a>
    <!-- Incidents Link -->
    <a
      href="{% url 'incidents' %}"
      class="py-2 px-6 text-sm font-normal
             transition-all duration-200 select-none cursor-pointer 
             hover:text-accent hover:bg-primaryHighlight"
    >
      Incidents
    </a>
  </nav>
</div>

<div class="flex text-5xl font-bold mb-8">Logs Page</div>

<!-- Logs Table -->
<div class="-m-2.5 overflow-auto">
    <div class="p-1.5 min-w-full inline-block justify-center h-[50vh] overflow-y-scroll">
        <div class="overflow-hidden shadow-md rounded-lg">
            <div class="table border-collapse table-auto w-full divide-y divide-gray-100">
                <div class="table-header-group">
                    <div class="table-row bg-gray-50 dark:bg-gray-700">
                        <div
                            class="table-cell px-6 py-3 text-center text-xl font-bold text-white-500 uppercase light:text-neutral-500">
                            ID</div>
                        <div
                            class="table-cell px-6 py-3 text-center text-xl font-bold text-white-500 uppercase light:text-neutral-500">
                            Created At</div>
                        <div
                            class="table-cell px-6 py-3 text-center text-xl font-bold text-white-500 uppercase light:text-neutral-500">
                            Log</div>
                    </div>
                </div>
                <div class="table-row-group divide-y divide-gray-100 border-b dark:bg-gray-800 dark:border-gray-700">
                    {% for log in logs %}
                    <div class="table-row">
                        <div
                            class="table-cell px-6 py-4 whitespace-nowrap text-sm text-center font-medium text-gray-800 dark:text-neutral-100">
                            {{ log.id }}</div>
                        <div
                            class="table-cell
                                px-6 py-4 whitespace-nowrap text-sm text-center font-medium text-gray-800 dark:text-neutral-100">
                            {{ log.created_at }}</div>
                        <div
                            class="table-cell
                                px-6 py-4 whitespace-nowrap text-sm text-center font-medium text-gray-800 dark:text-neutral-100">
                            {{ log.log }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Pagination Controls -->
<div id="paginationControls" class="mt-4 flex justify-center items-center space-x-4">
    <button id="prevPage" class="px-4 py-2 bg-gray-700 text-gray-200 rounded disabled:opacity-50" disabled>Prev</button>
    <span id="pageInfo" class="text-lg">Page 1</span>
    <button id="nextPage" class="px-4 py-2 bg-gray-700 text-gray-200 rounded">Next</button>
</div>

<!-- JavaScript for Pagination -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const rows = document.querySelectorAll('#logsTable tbody tr');
        const rowsPerPage = 50;
        let currentPage = 1;
        const totalPages = Math.ceil(rows.length / rowsPerPage);

        const prevButton = document.getElementById('prevPage');
        const nextButton = document.getElementById('nextPage');
        const pageInfo = document.getElementById('pageInfo');

        function showPage(page) {
            // Validate page number
            if (page < 1) page = 1;
            if (page > totalPages) page = totalPages;

            // Hide all rows
            rows.forEach((row) => {
                row.classList.add('hidden');
            });

            // Calculate start/end
            const start = (page - 1) * rowsPerPage;
            const end = start + rowsPerPage;

            // Show rows for the current page
            for (let i = start; i < end && i < rows.length; i++) {
                rows[i].classList.remove('hidden');
            }

            // Update page info
            pageInfo.innerText = `Page ${page} of ${totalPages}`;
            prevButton.disabled = page === 1;
            nextButton.disabled = page === totalPages;

            // Update current page
            currentPage = page;
        }

        // Show initial page
        showPage(currentPage);

        // Pagination events
        prevButton.addEventListener('click', function () {
            if (currentPage > 1) showPage(currentPage - 1);
        });
        nextButton.addEventListener('click', function () {
            if (currentPage < totalPages) showPage(currentPage + 1);
        });
    });
</script>

{% endblock content %}
